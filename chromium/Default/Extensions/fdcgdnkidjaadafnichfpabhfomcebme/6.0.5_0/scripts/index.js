!function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return o(n||e)},l,l.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){!function(n,r){"object"==typeof t&&t.exports&&"function"==typeof e?t.exports=r():"function"==typeof define&&"object"==typeof define.amd?define(r):n.log=r()}(this,function(){function e(e){return typeof console!==s&&(void 0!==console[e]?t(console,e):void 0!==console.log?t(console,"log"):a)}function t(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function n(e,t){return function(){typeof console!==s&&(r(t),i[e].apply(i,arguments))}}function r(e){for(var t=0;t<u.length;t++){var n=u[t];i[n]=t<e?a:i.methodFactory(n,e)}}function o(e){var t=(u[e]||"silent").toUpperCase();try{return void(window.localStorage.loglevel=t)}catch(e){}try{window.document.cookie="loglevel="+t+";"}catch(e){}}var i={},a=function(){},s="undefined",u=["trace","debug","info","warn","error"];i.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},i.methodFactory=function(t,r){return e(t)||n(t,r)},i.setLevel=function(e,t){if("string"==typeof e&&void 0!==i.levels[e.toUpperCase()]&&(e=i.levels[e.toUpperCase()]),!("number"==typeof e&&e>=0&&e<=i.levels.SILENT))throw"log.setLevel() called with invalid level: "+e;if(!1!==t&&o(e),r(e),typeof console===s&&e<i.levels.SILENT)return"No console available for logging"},i.enableAll=function(e){i.setLevel(i.levels.TRACE,e)},i.disableAll=function(e){i.setLevel(i.levels.SILENT,e)};var c=typeof window!==s?window.log:void 0;return i.noConflict=function(){return typeof window!==s&&window.log===i&&(window.log=c),i},function(){var e;try{e=window.localStorage.loglevel}catch(e){}if(typeof e===s)try{e=/loglevel=([^;]+)/.exec(window.document.cookie)[1]}catch(e){}void 0===i.levels[e]&&(e="WARN"),i.setLevel(i.levels[e],!1)}(),i})},{}],2:[function(e,t,n){!function(e,r){"use strict";var o="model",i="name",a="type",s="vendor",u="version",c="mobile",l="tablet",d={extend:function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},f={rgx:function(){for(var e,t,n,r,o,i,a,s=0,u=arguments;s<u.length&&!i;){var c=u[s],l=u[s+1];if(void 0===e){e={};for(r in l)l.hasOwnProperty(r)&&(o=l[r],"object"==typeof o?e[o[0]]=void 0:e[o]=void 0)}for(t=n=0;t<c.length&&!i;)if(i=c[t++].exec(this.getUA()))for(r=0;r<l.length;r++)a=i[++n],o=l[r],"object"==typeof o&&o.length>0?2==o.length?"function"==typeof o[1]?e[o[0]]=o[1].call(this,a):e[o[0]]=o[1]:3==o.length?"function"!=typeof o[1]||o[1].exec&&o[1].test?e[o[0]]=a?a.replace(o[1],o[2]):void 0:e[o[0]]=a?o[1].call(this,a,o[2]):void 0:4==o.length&&(e[o[0]]=a?o[3].call(this,a.replace(o[1],o[2])):void 0):e[o]=a||void 0;s+=2}return e},str:function(e,t){for(var n in t)if("object"==typeof t[n]&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(d.has(t[n][r],e))return"?"===n?void 0:n}else if(d.has(t[n],e))return"?"===n?void 0:n;return e}},p={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},m={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[i,u],[/(opios)[\/\s]+([\w\.]+)/i],[[i,"Opera Mini"],u],[/\s(opr)\/([\w\.]+)/i],[[i,"Opera"],u],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs)\/([\w\.-]+)/i],[i,u],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[i,"IE"],u],[/(edge)\/((\d+)?[\w\.]+)/i],[i,u],[/(yabrowser)\/([\w\.]+)/i],[[i,"Yandex"],u],[/(comodo_dragon)\/([\w\.]+)/i],[[i,/_/g," "],u],[/(micromessenger)\/([\w\.]+)/i],[[i,"WeChat"],u],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[u,[i,"MIUI Browser"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[i,/(.+)/,"$1 WebView"],u],[/android.+samsungbrowser\/([\w\.]+)/i,/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[u,[i,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(qqbrowser)[\/\s]?([\w\.]+)/i],[i,u],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/juc.+(ucweb)[\/\s]?([\w\.]+)/i],[[i,"UCBrowser"],u],[/(dolfin)\/([\w\.]+)/i],[[i,"Dolphin"],u],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[i,"Chrome"],u],[/;fbav\/([\w\.]+);/i],[u,[i,"Facebook"]],[/fxios\/([\w\.-]+)/i],[u,[i,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[u,[i,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[u,i],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[i,[u,f.str,p.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[i,u],[/(navigator|netscape)\/([\w\.-]+)/i],[[i,"Netscape"],u],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[i,u]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",d.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",d.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",d.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[o,s,[a,l]],[/applecoremedia\/[\w\.]+ \((ipad)/],[o,[s,"Apple"],[a,l]],[/(apple\s{0,1}tv)/i],[[o,"Apple TV"],[s,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[s,o,[a,l]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[o,[s,"Amazon"],[a,l]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[o,f.str,p.device.amazon.model],[s,"Amazon"],[a,c]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[o,s,[a,c]],[/\((ip[honed|\s\w*]+);/i],[o,[s,"Apple"],[a,c]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[s,o,[a,c]],[/\(bb10;\s(\w+)/i],[o,[s,"BlackBerry"],[a,c]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[o,[s,"Asus"],[a,l]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[s,"Sony"],[o,"Xperia Tablet"],[a,l]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[s,"Sony"],[o,"Xperia Phone"],[a,c]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[s,o,[a,"console"]],[/android.+;\s(shield)\sbuild/i],[o,[s,"Nvidia"],[a,"console"]],[/(playstation\s[34portablevi]+)/i],[o,[s,"Sony"],[a,"console"]],[/(sprint\s(\w+))/i],[[s,f.str,p.device.sprint.vendor],[o,f.str,p.device.sprint.model],[a,c]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[s,o,[a,l]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[s,[o,/_/g," "],[a,c]],[/(nexus\s9)/i],[o,[s,"HTC"],[a,l]],[/(nexus\s6p)/i],[o,[s,"Huawei"],[a,c]],[/(microsoft);\s(lumia[\s\w]+)/i],[s,o,[a,c]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[o,[s,"Microsoft"],[a,"console"]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[s,"Microsoft"],[a,c]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[o,[s,"Motorola"],[a,c]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[o,[s,"Motorola"],[a,l]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[s,d.trim],[o,d.trim],[a,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[s,"Samsung"],[a,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[o,[s,"Sharp"],[a,"smarttv"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[s,"Samsung"],o,[a,l]],[/smart-tv.+(samsung)/i],[s,[a,"smarttv"],o],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[s,"Samsung"],o,[a,c]],[/sie-(\w+)*/i],[o,[s,"Siemens"],[a,c]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[s,"Nokia"],o,[a,c]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[o,[s,"Acer"],[a,l]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[s,"LG"],o,[a,l]],[/(lg) netcast\.tv/i],[s,o,[a,"smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[o,[s,"LG"],[a,c]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[o,[s,"Lenovo"],[a,l]],[/linux;.+((jolla));/i],[s,o,[a,c]],[/((pebble))app\/[\d\.]+\s/i],[s,o,[a,"wearable"]],[/android.+;\s(glass)\s\d/i],[o,[s,"Google"],[a,"wearable"]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[o,/_/g," "],[s,"Xiaomi"],[a,c]],[/android.+a000(1)\s+build/i],[o,[s,"OnePlus"],[a,c]],[/\s(tablet)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[a,d.lowerize],s,o]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[u,[i,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[i,u],[/rv\:([\w\.]+).*(gecko)/i],[u,i]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[i,u],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[i,[u,f.str,p.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[i,"Windows"],[u,f.str,p.os.windows.version]],[/\((bb)(10);/i],[[i,"BlackBerry"],u],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[i,u],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[i,"Symbian"],u],[/\((series40);/i],[i],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[i,"Firefox OS"],u],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[i,u],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[i,"Chromium OS"],u],[/(sunos)\s?([\w\.]+\d)*/i],[[i,"Solaris"],u],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[i,u],[/(haiku)\s(\w+)/i],[i,u],[/(ip[honead]+)(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[i,"iOS"],[u,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[i,"Mac OS"],[u,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[i,u]]},g=function(t,n){if(!(this instanceof g))return new g(t,n).getResult();var r=t||(e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:""),o=n?d.extend(m,n):m;return this.getBrowser=function(){var e=f.rgx.apply(this,o.browser);return e.major=d.major(e.version),e},this.getCPU=function(){return f.rgx.apply(this,o.cpu)},this.getDevice=function(){return f.rgx.apply(this,o.device)},this.getEngine=function(){return f.rgx.apply(this,o.engine)},this.getOS=function(){return f.rgx.apply(this,o.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=e,this},this};g.VERSION="0.7.12",g.BROWSER={NAME:i,MAJOR:"major",VERSION:u},g.CPU={ARCHITECTURE:"architecture"},g.DEVICE={MODEL:o,VENDOR:s,TYPE:a,CONSOLE:"console",MOBILE:c,SMARTTV:"smarttv",TABLET:l,WEARABLE:"wearable",EMBEDDED:"embedded"},g.ENGINE={NAME:i,VERSION:u},g.OS={NAME:i,VERSION:u},void 0!==n?(void 0!==t&&t.exports&&(n=t.exports=g),n.UAParser=g):"function"==typeof define&&define.amd?define(function(){return g}):e.UAParser=g;var w=e.jQuery||e.Zepto;if(void 0!==w){var v=new g;w.ua=v.getResult(),w.ua.get=function(){return v.getUA()},w.ua.set=function(e){v.setUA(e);var t=v.getResult();for(var n in t)w.ua[n]=t[n]}}}("object"==typeof window?window:this)},{}],3:[function(e,t,n){(function(t){"use strict";var r=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=void 0,i=void 0,a="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,s=e("storage"),u=e("auth"),c=e("browser"),l=e("./url-resolver"),d=e("./registration"),f=d.signIn,p=d.signOut,m=e("./update"),g=e("./language"),w=g.messages;n.device=o=a.fromPromise(s.read("device")).skipErrors().merge(f.merge(m).map(function(e){return e.device})).filter(function(e){return e}).scan({},function(e,t){for(var n in t){var r=t[n];e[n]=r}return e}).changes().merge(p.map(null)).toProperty(),o.onValue(function(e){return e?(s.write("device",e),u.setCredentials(e.uuid,e.token)):s.delete("device")}),n.user=i=a.fromPromise(s.read("user")).skipErrors().merge(f.merge(m).map(function(e){return e.user})).filter(function(e){return e}).merge(p.map(null)).toProperty(),i.onValue(function(e){return e?s.write("user",e):s.delete("user")}),i.slidingWindow(2,2).filter(function(e){var t=r(e,2),n=t[0],o=t[1];return n&&o&&n.hasOwnProperty("is_premium")&&o.hasOwnProperty("is_premium")}).filter(function(e){var t=r(e,2),n=t[0],o=t[1];return n.is_premium!==o.is_premium}).map(function(e){var t=r(e,2);t[0];return t[1].is_premium}).flatMap(function(e){return a.combineAsArray(o.take(1),w.take(1),e)}).map(function(t){var n=r(t,3),o=(n[0],n[1]),i=n[2],a=o.notifications.status_change;if(i)return[a.upgraded_title,a.upgraded_msg,null];l=e("./url-resolver");var s=l("account/premium",{utm_medium:"product",utm_source:"extension-notification",utm_campaign:"premium-promotion"});return[a.downgraded_title,a.downgraded_msg,s]}).onValues(function(e,t,n){var r={type:"basic",title:e,message:t},o={title:e,text:t,data:{url:n}};return c.notify({chrome:{newsItem:r,data:{url:n}},firefox:o})})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./language":34,"./registration":47,"./update":54,"./url-resolver":55,auth:5,browser:9,storage:50}],4:[function(e,t,n){(function(n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s.retry({source:function(){return s.fromPromise(c({url:w.get().apiURL+"/v2/"+e,responseType:"json",method:t,data:n,headers:{"x-rm-url":w.get().apiURLs[0]}})).flatMapError(function(e){return s.combineAsArray([e,d]).flatMap(function(e){var t=a(e,2),n=t[0],r=t[1];return g({error:n,stickyFrontingDomain:r}).flatMap(function(e){return s.once(new s.Error(e))})})})},retries:2,isRetryable:function(e){var t=e.error;return!!e.online&&(e.frontingDomain?f(e.frontingDomain):e.apiUrl&&w.setApiURL(e.apiUrl),!t||403!==t.status)},delay:function(){return 250}}).map(function(e){return e.payload})}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s.fromPromise(p.read("device")).skipErrors().flatMapLatest(function(o){return r(e,t,i({},n,{auth_method:"device",auth_id:o.uuid,auth_secret:o.token}))})}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,u=e("xhr"),c=u.request,l=e("fronting"),d=l.stickyFrontDomain,f=l.enableFullFronting,p=e("storage"),m=e("./connectivity"),g=m.connectivityCheck,w=e("./config");t.exports={apiRequest:r,apiRequestWithAuth:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./config":11,"./connectivity":13,fronting:29,storage:50,xhr:59}],5:[function(e,t,n){"use strict";var r=(e("loglevel"),"no_data_in_plugin"),o="no_data_in_plugin",i="";n.setCredentials=function(e,t){r=e,o=t},n.setFeatureFlags=function(e){i=e},n.authHandler=function(e,t){if(!e.isProxy||!e.realm.toLowerCase().includes("zenmate"))return t?t():Promise.resolve();var n=r;i&&(n+=";"+i);var a={authCredentials:{username:n,password:o}};return t?t(a):Promise.resolve(a)}},{loglevel:1}],6:[function(e,t,n){"use strict";var r=window,o=r.atob,i=r.btoa;t.exports={atob:o,btoa:i}},{}],7:[function(e,t,n){(function(t){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,o=(e("loglevel"),e("./util")),i=r.fromBinder(function(e){if(o.isChrome)return chrome.management.onEnabled.addListener(e),chrome.management.onDisabled.addListener(e),chrome.proxy.settings.onChange.addListener(e)}).flatMapLatest(function(){return a()}),a=function(){return r.fromCallback(function(e){if(o.isChrome)return chrome.proxy.settings.get({incognito:!1},e)})};n.proxyBlocked=a().merge(i).map(function(e){return!["controllable_by_this_extension","controlled_by_this_extension"].includes(e&&e.levelOfControl)}).toProperty(!1),n.proxyBlockedBy=n.proxyBlocked.flatMapLatest(function(e){return r.fromCallback(function(t){return e?chrome.management.getAll(function(e){var n=e.filter(function(e){return chrome.runtime.id!==e.id&&e.enabled&&e.permissions.includes("proxy")}).map(function(e){return{id:e.id,name:e.name,icon:e.icons&&e.icons[0].url}});return t(n)}):t([])})}).toProperty()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util":56,loglevel:1}],8:[function(e,t,n){(function(n){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,o=e("browser"),i=e("./tab-info"),a=e("./config"),s=e("./language"),u=s.messages,c=i.filter(function(e){return!!a.get().blockedSites.includes(e.host)&&(o.closePage(e.url),!0)}).map(function(e){return e.url});r.combineAsArray(c,u).onValues(function(e,t){var n=t.notifications.blocked_site.title,r=t.notifications.blocked_site.message.replace("{blockedURL}",e),i={type:"basic",title:n,message:r},a={title:n,text:r,data:{}};return o.notify({chrome:{newsItem:i,data:{}},firefox:a})}),t.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./config":11,"./language":34,"./tab-info":51,browser:9}],9:[function(e,t,n){(function(t){"use strict";var r=void 0,o=void 0,i="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,a=e("loglevel"),s=e("./api_request"),u=s.apiRequest,c=e("./fronting"),l=c.enableFronting,d=e("./storage"),f=e("./url-resolver"),p=e("./auth"),m=p.authHandler,g=e("./util"),w=e("./config"),v=e("./pacengine"),b=e("ua-parser-js");e("./page_api"),e("./ciuvo_messages");var h=new b(navigator.userAgent).getResult();n.getName=function(){return h.browser.name},n.getInstallSource=function(e){var t=[{name:"website",pattern:"*://zenmate.com/*",host:"zenmate.com/"},{name:"chromestore",pattern:"*://chrome.google.com/webstore/detail/*/"+chrome.runtime.id+"*",host:"chrome.google.com/"},{name:"operastore",pattern:"*://addons.opera.com/*/extensions/details/zenmate-for-operatm/*",host:"addons.opera.com/"}];try{return chrome.tabs.query({url:t.map(function(e){return e.pattern})},function(n){var r=!0,o=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value,c=g.getUTMSourcesFromURL(u.url),l=!0,d=!1,f=void 0;try{for(var p,m=t[Symbol.iterator]();!(l=(p=m.next()).done);l=!0){var w=p.value;if(u.url.indexOf(w.host)>-1)return e("url="+w.name+";"+c)}}catch(e){d=!0,f=e}finally{try{!l&&m.return&&m.return()}finally{if(d)throw f}}}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return e("unknown")})}catch(t){return a.error(t),e("unknown")}};var y=function(e){return g.isChrome?f("onboarding/version-one",e):f("onboarding/version-ff",e)},_=function(e){return e.login="y",y(e)};n.openSignupPage=function(){return n.getInstallSource(function(e){if(e.includes(";")){e=e.split(";")[0].split("=")[1]}var t={utm_medium:"product",utm_source:"extension-tabspawn",utm_content:"onboarding"};return d.read("signup_shown").then(function(){return n.openPage(_(t))}).catch(function(){return d.write("signup_shown",!0),n.openPage(y(t))})})},n.openPage=o=function(e){return chrome.tabs.create({url:e,active:!0},function(e){return chrome.windows.update(e.windowId,{focused:!0})})},n.openPopup=function(e,t){return chrome.windows.create({type:"popup",url:e,width:1024,top:0,height:700},t)},n.closePage=function(e,t){return chrome.tabs.query({url:e},function(e){if(e)return e.filter(function(e){return e.id!==t}).map(function(e){return chrome.tabs.remove(e.id)})})},n.closePopup=function(){return!1},n.getExtensionURL=r=function(e){return chrome.extension.getURL(e)},n.setIconAction=function(e){return"popup"===e?chrome.browserAction.setPopup({popup:"popup.html"}):chrome.browserAction.setPopup({popup:""})},chrome&&(chrome.browserAction.onClicked.addListener(function(){return n.openSignupPage()}),chrome.runtime.onInstalled.addListener(function(e){if("update"===e.reason)return u("et/upgrade","GET",{previous_version:e.previousVersion}).onValue()}));if(n.setup=function(){return chrome.runtime.onUpdateAvailable.addListener(function(){return chrome.runtime.reload()}),chrome.runtime.setUninstallURL(f("account/uninstall",{utm_medium:"product",utm_source:"extension-tabspawn",utm_content:"uninstall-feedback"})),chrome.webRequest.onBeforeSendHeaders.addListener(function(e){return{cancel:!0}},{urls:["*://www.google.com/searchdomaincheck*"]},["blocking"]),chrome.proxy.onProxyError.addListener(function(e){return a.warn("Proxy error",e)}),l().then(function(){return d.read("device").then(function(e){return!(!e.uuid||!e.token)}).catch(function(){return!1})})},n.hasIncognitoAccess=function(e){return chrome.extension.isAllowedIncognitoAccess(function(t){return e(t)})},!g.isChrome){browser.proxy.register("scripts/pac-firefox.js"),browser.proxy.onProxyError.addListener(function(e){return console.error("Proxy error: "+e.message)})}n.connect=function(e,t,n,r){var o=v.getNodeDictFromLocations(t,w.get().alternativeNodes),i=v.exportPAC(e.country_code,o,n,r),a={value:{mode:"pac_script",pacScript:{data:i}},scope:"regular"};g.isChrome?(chrome.proxy.settings.set(a,function(e){}),chrome.webRequest.onAuthRequired.addListener(m,{urls:["<all_urls>"]},["asyncBlocking"])):(browser.runtime.sendMessage({enabled:!0,defaultLocation:e.country_code,nodeDict:o,rules:n,pageExcludes:r},{toProxyScript:!0}),browser.webRequest.onAuthRequired.addListener(m,{urls:["<all_urls>"]},["blocking"]))},n.disconnect=function(){g.isChrome?(chrome.proxy.settings.set({value:{mode:"direct"},scope:"regular"},function(e){}),chrome.webRequest.onAuthRequired.removeListener(m)):(browser.runtime.sendMessage({enabled:!1},{toProxyScript:!0}),browser.webRequest.onAuthRequired.removeListener(m))};var x={signedout:{38:r("icons/standard-38.png"),19:r("icons/standard-19.png")},enabled:{38:r("icons/enabled-38.png"),19:r("icons/enabled-19.png")},disabled:{38:r("icons/disabled-38.png"),19:r("icons/disabled-19.png")}};n.setIconImage=function(e,t){var n={path:x[e.toLowerCase()]};return t&&(n.tabId=t),chrome.browserAction.setIcon(n)},n.setIconTitle=function(e,t){var n={title:"ZenMate"};return e&&(n.title=n.title+"\n"+e),chrome.browserAction.setTitle(n)},n.setIconBadge=function(e,t,n){return n||(n="#008ace"),chrome.browserAction.setBadgeBackgroundColor({color:n}),chrome.browserAction.setBadgeText({text:e||"",tabId:t})};var L={},E={},k=null;n.notificationEvents=i.fromBinder(function(e){return k=e});var P=function(e,t){var n=void 0;if(chrome.notifications.clear(e),n="number"==typeof t?L[e]&&L[e][t]&&L[e][t].url:E[e]){if(n.startsWith("http"))return o(n,!1);if(n.startsWith("event"))return k({event:n.replace("event://",""),notificationId:e})}};chrome.notifications.onClicked.addListener(P),chrome.notifications.onButtonClicked.addListener(P),n.notify=function(e){var t=e.chrome.newsItem,n=e.chrome.data;t.iconUrl=r("images/notification_chrome@2x.png"),t.eventTime=Date.now(),t.title=t.title||chrome.runtime.getManifest().name,t.isClickable=n&&n.url;var o=n&&n.id||JSON.stringify(e);return n&&n.actions&&(t.buttons=n.actions.map(function(e){return{title:e.text}}),L[o]=n.actions),n&&n.url&&(E[o]=n.url),chrome.notifications.create(o,t,function(e){})},n.fullReset=function(){},n.getLocale=function(){return navigator.language.toString().toLowerCase().split("-")[0]||"en"},n.getVersion=function(){return chrome.runtime.getManifest().version},n.unblockProxySettings=function(){return null}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./api_request":4,"./auth":5,"./ciuvo_messages":10,"./config":11,"./fronting":29,"./pacengine":43,"./page_api":44,"./storage":50,"./url-resolver":55,"./util":56,loglevel:1,"ua-parser-js":2}],10:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=e("./emitter"),s=(e("loglevel"),e("./config")),u=e("./install_id"),c=void 0,l=s.get().ciuvoSettings;u.onValue(function(e){"undefined"!=typeof ciuvoSDK&&(l.uuid=e,c=new ciuvoSDK.Whitelist(l))});var d=function(e,t,n){c&&c.isWhitelisted(t,function(){var t={file:"scripts/vendor/ciuvo-contentscript.min.js"},n=function(t){chrome.tabs.sendMessage(e,{action:"runCiuvo",settings:l})};try{chrome.tabs.executeScript(e,t,n)}catch(e){}},function(e){})},f=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return"undefined"==typeof ciuvoSDK?o(e):(chrome.runtime.onMessage.addListener(function(t,n){var r=n.tab.id;if(t&&"pageLoaded"===t.action&&t.top&&d(r,t.url,n.tab),t&&"disableSmartPrice"===t.action)return e.trigger("disableSmartPrice")}),e)}return i(t,e),t}(a);t.exports=new f},{"./config":11,"./emitter":25,"./install_id":32,loglevel:1}],11:[function(e,t,n){"use strict";function r(e){e&&(u.logLevel=e,s.setLevel(u.logLevel),console.info("logLevel:",u.logLevel))}function o(e){e&&(u.apiURL=e,console.info("api:",u.apiURL))}function i(e){e&&(u.newsServiceUrl=e,console.info("newsServiceUrl:",u.newsServiceUrl))}function a(e){e&&(u.authApiDomain=e,console.info("authApiDomain:",u.authApiDomain))}var s=e("loglevel"),u={logLevel:"silent",apiURL:"https://api.zcdn.de",apiURLs:["https://api.zcdn.de"],apiFront:"d1mvkhn4psrs16.cloudfront.net",geoRedirector:"https://geo.zenmate.com",websiteFront:"d21e7xkr9vlo60.cloudfront.net",websiteAssets:"du3rt6yhb1dqh.cloudfront.net",criticalWebsiteDomains:["zenmate.com"],websiteDomains:["zenmate.com","zenmate.ae","zenmate.ma","zenmate.dk","zenmate.at","zenmate.ch","zenmate.de","zenmate.li","zenmate.ca","zenmate.co.uk","zenmate.ie","zenmate.co.nz","zenmate.com.ar","zenmate.cl","zenmate.co","zenmate.es","zenmate.mx","zenmate.com.pa","zenmate.com.pe","zenmate.com.ve","zenmate.fi","zenmate.fr","zenmate.co.il","zenmate.in","zenmate.hu","zenmate.co.id","zenmate.is","zenmate.it","zenmate.jp","zenmate.kr","zenmate.lu","zenmate.lt","zenmate.lv","zenmate.my","zenmate.be","zenmate.nl","zenmate.pl","zenmate.com.br","zenmate.pt","zenmate.ro","zenmate.com.ru","zenmate.se","zenmate.sg","zenmate.com.ph","zenmate.com.tr","zenmate.pk","zenmate.vn","zenmate.hk"],domainFronts:"WyJhZGN0LmNhIiwiYWlydmlzdGFyYS5jb20iLCJhbGRpLmRlIiwiYW1pcmVudHN0YWJpbGl6ZWQuY29tIiwiYW5zd2VyYmFja21hY2hpbmUub3JnIiwiYXBpLnZvZC5nbG9ib3NhdC50diIsImFzaWF3ZWJkaXJlY3QuY29tIiwiYXdzLWJsb2cuaW8iLCJib21ib3JhdGVjaC5jb20uYXUiLCJjZG4taW1hZ2VzLm1haWxjaGltcC5jb20iLCJjZG4uZGV2LmFvcC5hY2VyLmNvbSIsImNkbi5lcmluY2FsbC5jb20iLCJjZi5kcm9wYm94cGF5bWVudHMuY29tIiwiY2hyb25pY2xlLmNvbSIsImNsYXNob2ZjbGFucy5jb20iLCJjbGllbnR1cGRhdGVzLmRyb3Bib3hzdGF0aWMuY29tIiwiY29ubmVjdGl2aXR5LmFtYXpvbndvcmtzcGFjZXMuY29tIiwiY3Jvc3NldC5vbndhcmQuY28uanAiLCJkZXJhdXRvcGlsb3QuY29tIiwiZGV2YnVpbGRzLnViZXIuY29tIiwiZGV2ZWxvcGVyLnNvbnkuY29tIiwiZGV2aWFudGFydC5jb20iLCJkZXZyZWwuanAiLCJkb3dubG9hZC5lcGljZ2FtZXMuY29tIiwiZXBzb24uY29tIiwiZmFuY3JlZC5vcmciLCJmaWZhY29ubmVjdC5vcmciLCJmaXRiaXQuY29tIiwiaGJyLm9yZyIsImhic3AuaGFydmFyZC5lZHUiLCJoc2N1Lm5ldCIsImh1Yi1vbG9neS5vcmciLCJpZmxpeC5jb20iLCJpbWFnZXMtbmEuc3NsLWltYWdlcy1hbWF6b24uY29tIiwiaW5mb2pvYnMubmV0IiwianRjbGFyay5jYSIsImtpY2tzdGFydGVyLmNvbSIsIm1lcmNhcmkuY29tIiwibWluZWNyYWZ0Lm5ldCIsIm1pdG1wcm94eS5vcmciLCJteHRvb2xib3guY29tIiwib2xhY2Ficy5jb20iLCJvcGVucmVwdXRhdGlvbi5uZXQiLCJxdWl6dXAuY29tIiwicmF6b3JzcWwuY29tIiwicm92ZXIuY29tIiwic2hhcmUub3JpZ2luLjljZG4ubmV0Iiwic21hbGxwZGYuY29tIiwic3RhdGljLnVuZS5lZHUuYXUiLCJzeXNhZG1pbmNhc3RzLmNvbSIsInRoYWlzbWlsZWFpci5jb20iLCJ1bmZvbGRpbmd3b3JkLm9yZyIsInZlcnNhbmQtc3RhdHVzLmRlIiwid2RjLmNvbSIsIndpbWR1LmNvbS50ciIsIndpbWR1LmRlIiwid293YWlyLmlzIiwid3d3LmFwdGx5LmluZm8iLCJ3d3cuYmViZXN0b3JlLmNvbS5iciIsInd3dy5jbWNtLmNvbSIsInd3dy5pa3VzYWxpYy5jb20iLCJ3d3cubHBnYS5vci5qcCIsInd3dy5wYXlwYWwtZHluYW1pYy5jb20iLCJ3d3cudGlyZWRwaXhlbC5jb20iLCJ3d3cudW5yb2xsLm1lIiwieWNvbWJpbmF0b3IuY29tIl0=",authApiDomain:"auth.zenmate.com",authApiDomains:["auth.zenmate.com"],newsServiceUrl:"https://crm.zenguard.biz",newsServiceUrls:["https://crm.zenguard.biz"],newsServiceFront:"d3h6bpau3gi7cm.cloudfront.net",connectionCheckDomains:[{url:"http://www.google.com.sg/gen_204",code:204},{url:"http://g.cn/generate_204",code:204},{url:"http://www.thinkdifferent.us",code:200},{url:"http://www.airport.us",code:200},{url:"http://detectportal.firefox.com/success.txt",code:200},{url:"http://captive.apple.com",code:200}],
localDomains:["zenguard.biz","zcdn.de","zeus.pm","local","ip","fritz.box","kabel.box","invalid","intra","intranet","test","example","localhost","onion","i2p","lvh.me","vcap.me","127.0.0.1.xip.io","localtest.me","about:addons","about:newtab","about:preferences","about:config","about:debugging"],blackList:{"jid1-4P0kohSJxU1qGg@jetpack":"hola"},alternativeNodes:[],nodeOverrides:[],ruleOverrides:[{domains:["facebook.com"],hosts:["facebook.net","fbcdn.com","fbcdn.net","fbstatic-a.akamaihd.net","fbcdn-dragon-a.akamaihd.net"]}],blockedSites:["appnord.xyz"],ciuvoSettings:{base_url:"https://sp.zenmate.com/api/",tag:"z3Nnno43",campaign:"chrome"}};r("silent"),"undefined"!=typeof window&&(window.config=u),t.exports={get:function(){return u},setLogLevel:r,setApiURL:o,setNewsServiceUrl:i,setAuthApiDomain:a}},{loglevel:1}],12:[function(e,t,n){(function(n){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,o=e("browser"),i=e("./logged-in"),a=e("./enabled"),s=e("./rules"),u=s.rules,c=s.rulesEnabled,l=e("blocked"),d=l.proxyBlocked,f=e("./locations"),p=e("./locations/default"),m=(e("loglevel"),e("./page_excludes")),g=e("./util"),w=g.shuffle;t.exports=r.combineAsArray(i.and(d.not()).skipDuplicates(),a,p,f,u,c,m).onValues(function(e,t,n,r,i,a,s){if(!e)return o.disconnect();var u=a&&i.length>0;return n.nodes&&w(n.nodes),u&&!t&&(n={country_code:"DEFAULT"}),u||(i=[]),t||u?o.connect(n,r,i,s):o.disconnect()})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./enabled":26,"./locations":38,"./locations/default":36,"./logged-in":39,"./page_excludes":45,"./rules":48,"./util":56,blocked:7,browser:9,loglevel:1}],13:[function(e,t,n){(function(t){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,o=e("xhr"),i=o.request,a=e("./util"),s=a.shuffle,u=a.chunk,c=e("./config"),l=e("base64"),d=l.atob,f=JSON.parse(d(c.get().domainFronts));n.checkConnection=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",o=arguments[3];return r.fromPromise(i({url:e,method:n,headers:o})).map(function(e){return e.status===t}).flatMapError(function(e){return e.status===t?r.once(!0):r.once(!1)}).merge(r.later(1e4,!1)).first()},n.checkPing=function(e){return n.checkConnection(e+"/ping",599,"HEAD",{"x-rm-url":c.get().apiURLs[0]})},n.websiteConnectionCheck=function(){return r.fromArray(c.get().criticalWebsiteDomains).flatMap(function(e){return n.checkConnection("https://"+e+"/robots.txt",200)}).reduce(!0,function(e,t){return e&&t})},n.apiConnectionCheck=function(){return r.fromArray(c.get().apiURLs).flatMap(function(e){return n.checkPing(e).map(function(t){return t?e:null})}).reduce(null,function(e,t){return e||t})},n.apiFrontingCheck=function(e){var t=u(s(f),3),o=!0;return n.checkPing("https://"+e).flatMap(function(i){return i?r.once(e):r.fromArray(t).flatMapConcat(function(e){return r.fromArray(e).filter(function(){return o}).flatMap(function(e){return n.checkPing("https://"+e).map(function(t){return t?(o=!1,e):null})})}).reduce(null,function(e,t){return e||t})})},n.onlineCheck=function(){return r.fromArray(c.get().connectionCheckDomains).flatMap(function(e){return n.checkConnection(e.url,e.code)}).filter(function(e){return e}).mapEnd(!1).first()},n.connectivityCheck=function(e){var t=e.stickyFrontingDomain,o=e.error;return n.onlineCheck().flatMap(function(e){return e?r.combineTemplate({apiUrl:n.apiConnectionCheck(),websiteWorks:n.websiteConnectionCheck()}).flatMap(function(r){var i=r.apiUrl,a=r.websiteWorks;return i&&a?{apiUrl:i,websiteWorks:a,online:e,error:o}:n.apiFrontingCheck(t).map(function(t){return{frontingDomain:t,apiUrl:i,websiteWorks:a,online:e,error:o}})}):{online:e,error:o}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./config":11,"./util":56,base64:6,xhr:59}],14:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./config"),u=e("./emitter"),c=chrome,l=c.cookies,d=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.addListener(),e}return i(t,e),a(t,[{key:"getAuthCookie",value:function(){var e=this;return new Promise(function(t){return l.get({url:"https://"+s.get().authApiDomain,name:"auth_website_session"},function(n){n&&e.triggerLogin(n.value),t(n)})})}},{key:"removeAuthCookie",value:function(){console.log("removeAuthCookie","https://"+s.get().authApiDomain),l.remove({url:"https://"+s.get().authApiDomain,name:"auth_website_session"})}},{key:"triggerLogin",value:function(e){var t=JSON.parse(atob(e)),n={auth_method:"token",auth_id:t.id,auth_secret:t.token};this.trigger("login",n)}},{key:"addListener",value:function(){var e=this;l.onChanged.addListener(function(t){var n=t.cookie,r=t.removed,o=n.domain,i=n.name,a=n.path,u=n.value;o===s.get().authApiDomain&&"auth_website_session"===i&&"/"===a&&(r?e.trigger("logout"):e.triggerLogin(u))})}}]),t}(u);t.exports=new d},{"./config":11,"./emitter":25}],15:[function(e,t,n){(function(n){"use strict";function r(e,t){return Math.floor((e-t)/1e3/60/60/24)}function o(e){var t=e.user,n=e.device,o=e.language,a=e.defaultLocation,l=e.reason,f=e.tab,p=new Date,m=i.getName(),g=void 0,w=void 0,v=void 0,b=void 0,h=void 0,y=void 0,_=void 0,x=-1,L=-1,E=-1;return t&&(p=d(t.server_time),g=t.id,w=t.country_code,v=t.is_b2b?"b2b":t.is_premium?"premium":"free",h=t.actual_country,b=t.subscription_country,t.subscription&&t.subscription.purchased_at&&(L=r(p,d(t.subscription.purchased_at))),t.subscription&&t.subscription.expires_at&&(E=r(d(t.subscription.expires_at),p))),f&&(_=f.domain),n&&(x=r(p,d(n.created_at))),m&&(m=m.toLowerCase()),a&&(y=a.country_code),u.fromPromise(s({url:c.get().newsServiceUrl+"/crm",responseType:"json",data:{zenmate_user_id:g,locale:o,country_code:w,platform:m,version:i.getVersion(),account_type:v,reason:l,days_since_install:x,days_since_premium:L,days_to_recur:E,subscription_country:b,current_connect_country:y,actual_country:h,current_context:_},headers:{"x-rm-url":c.get().newsServiceUrls[0]}})).skipErrors().map(function(e){return e.payload})}var i=e("browser"),a=e("xhr"),s=a.request,u="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,c=e("../config"),l=e("../util"),d=l.parseDate;t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../config":11,"../util":56,browser:9,xhr:59}],16:[function(e,t,n){"use strict";t.exports={login:"login",timer:"timer",tab:"tab",initial:"initial"}},{}],17:[function(e,t,n){(function(n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,i=e("../account"),a=i.user,s=i.device,u=e("../locations/default"),c=e("../language"),l=c.language,d=e("./api"),f=e("./tab_watcher"),p=e("../registration"),m=p.signIn,g=e("./constants");t.exports=o.later(2e3,{reason:g.initial}).merge(o.interval(54e5,{reason:g.timer})).merge(m.map(function(){return{reason:g.login}})).merge(f.map(function(e){return{tab:e,reason:g.tab}})).flatMapLatest(function(e){var t=e.reason,n=e.tab;return o.combineTemplate({user:a,device:s,language:l,defaultLocation:u}).map(function(e){var o=r({},e,{reason:t,tab:n});return t=null,n=null,o})}).debounceImmediate(2e3).flatMapLatest(d)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../account":3,"../language":34,"../locations/default":36,"../registration":47,"./api":15,"./constants":16,"./tab_watcher":23}],18:[function(e,t,n){(function(n){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,o=e("browser"),i=e("storage"),a=e("../index"),s=r.fromPromise(i.read("notifications_blacklist")).mapError(function(){return[]}).flatMapLatest(function(e){return o.notificationEvents.filter(function(e){return"dontShowAgain"===e.event}).scan(e,function(e,t){var n=t.notificationId;return e.push(n),e})}).toProperty([]);s.onValue(function(e){i.write("notifications_blacklist",e)});var u=a.map(function(e){return e.contextNotification}).filter(function(e){return e}).combine(s,function(e,t){return t.includes(e.id)?null:e}).filter(function(e){return e});u.onValue(function(e){var t=e.id,n=e.title,r=e.text,i=e.actions,a={type:"basic",title:n,message:r,requireInteraction:!0};o.notify({chrome:{newsItem:a,data:{actions:i,id:t}}})}),t.exports=u}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../index":17,browser:9,storage:50}],19:[function(e,t,n){(function(n){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,o=e("storage"),i=e("../index"),a=e("../../popup"),s=a.popup,u=e("../../trial_end_promo"),c=u.showTrialEndNews,l=r.fromEvent(s,"request:popupOpen"),d=i.map(function(e){return e?e.news:void 0}).toProperty(null),f=r.mergeAll(c,d.filter(function(e){return e})).toProperty(null),p=r.fromPromise(o.read("previous_news")).mapError(function(){return[]}).flatMapLatest(function(e){return l.flatMapLatest(f.take(1)).scan(e,function(e,t){return t&&!e.includes(t.id)&&e.push(t.id),e})}).toProperty();p.onValue(function(e){return o.write("previous_news",e)}),t.exports=f.combine(p,function(e,t){return e&&!t.includes(e.id)?e.isNew=!0:e&&(e.isNew=!1),e})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../popup":46,"../../trial_end_promo":53,"../index":17,storage:50}],20:[function(e,t,n){(function(n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,i=e("storage"),a=e("browser"),s=e("../index"),u=s.map(function(e){return e.notification}).flatMapLatest(function(e){return o.combineAsArray(e,o.fromPromise(i.read("notifications")).mapError([]))}).toProperty();u.onValues(function(e,t){if(e&&-1===t.indexOf(e.id)){var n=e.id,o=e.title,s=e.text,u=e.url,c={type:"basic",title:o,message:s},l={title:o,text:s,data:{url:u}};return a.notify({chrome:{newsItem:c,data:{url:u}},firefox:l}),i.write("notifications",[].concat(r(t),[n]))}}),t.exports=u}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../index":17,browser:9,storage:50}],21:[function(e,t,n){(function(n){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,o=e("storage"),i=e("../index"),a=e("../../popup"),s=a.popup,u=i.filter(function(e){return null!=e?e.popUp:void 0}).map(function(e){return e.popUp}).toProperty(null),c=r.fromPromise(o.read("dismissed_crm_popups")).mapError(function(){return[]}).flatMapLatest(function(e){return r.fromEvent(s,"request:dismissCRMPopUp").map(function(t){return[t].concat(e)}).merge(r.once(e))});c.onValue(function(e){return o.write("dismissed_crm_popups",e)}),t.exports=u.combine(c,function(e,t){return e&&t.includes(e.id)?null:e})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../popup":46,"../index":17,storage:50}],22:[function(e,t,n){(function(n){"use strict";var r=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,i=e("storage"),a=e("browser"),s=e("../index"),u=e("../../popup"),c=u.popup,l=e("../../trial_end_promo"),d=l.showTrialEndTab,f=o.fromEvent(c,"request:popupOpen"),p=s.map(function(e){return e?e.tabSpawn:null}).toProperty(null),m=d.toProperty(null),g=o.combineAsArray(m,p);t.exports=g.flatMapLatest(function(e){return o.combineAsArray(o.fromPromise(i.read("previous_tab_spawns")).mapError([]),e).flatMapLatest(function(e){var t=r(e,2),n=t[0],s=t[1],u=!0,c=!1,l=void 0;try{for(var d,p=s[Symbol.iterator]();!(u=(d=p.next()).done);u=!0){var m=d.value;if(m&&!n.includes(m.id))return o.once(m).merge(f.take(1).doAction(function(){return i.write("previous_tab_spawns",n.concat(m.id)),a.openPage(m.url)}).map(null))}}catch(e){c=!0,l=e}finally{try{!u&&p.return&&p.return()}finally{if(c)throw l}}return null}).toProperty()})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../popup":46,"../../trial_end_promo":53,"../index":17,browser:9,storage:50}],23:[function(e,t,n){(function(n){"use strict";function r(e){var t=e.currentTab,n=e.whitelistedHost,r=t.id+"-"+n.domain;return!!d[r]||(d[r]=!0,!1)}var o="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,i=e("../config"),a=e("tab-info"),s=e("xhr"),u=s.request,c=i.get().newsServiceUrl+"/wl",l=o.once().delay(1e3).merge(o.interval(864e5)).flatMapLatest(function(){return o.fromPromise(u({url:c,method:"GET",responseType:"json",headers:{"x-rm-url":i.get().newsServiceUrls[0]}}))}).skipErrors().map(".payload.whitelist").filter(function(e){return e}).toProperty([]),d={},f=a.debounce(1e3),p=o.combineTemplate({whitelist:l,currentTab:f}).filter(".currentTab.host").map(function(e){var t=e.whitelist,n=e.currentTab,r=t.find(function(e){return n.host.includes(e.domain)});return{whitelist:t,currentTab:n,whitelistedHost:r}}).filter(".whitelistedHost").filter(function(e){return!r(e)}).map(".whitelistedHost").changes();t.exports=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../config":11,"tab-info":51,xhr:59}],24:[function(e,t,n){(function(e){"use strict"}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./config":11,"./popup":46,browser:9,loglevel:1,storage:50}],25:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){r(this,e),this.listeners={}}return o(e,[{key:"off",value:function(e,t){return this.listeners[e]=this.listeners[e]?this.listeners[e].filter(function(e){return e!==t}):void 0}},{key:"on",value:function(e,t){return this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"trigger",value:function(e,t){if(this.listeners[e])return this.listeners[e].map(function(e){return e(t)})}}]),e}();t.exports=i},{}],26:[function(e,t,n){(function(n){"use strict";var r=void 0,o="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,i=e("storage"),a=e("browser"),s=e("./popup"),u=s.popup,c=e("./options"),l=c.options,d=e("./logged-in"),f=e("./force-premium"),p=e("page_api"),m=a.notificationEvents.filter(function(e){var t=e.event;return t.startsWith("enable")||t.startsWith("disable")}).map(function(e){return e.event.startsWith("enable")}),g=o.fromEvent(l,"request:reset").flatMap(function(){return o.sequentially(25,[!1,!0])});t.exports=r=o.fromPromise(i.read("enabled")).mapError(function(){return!0}).merge(o.fromEvent(p,"toggle")).merge(o.fromEvent(u,"request:toggleProxy")).merge(g).merge(m).merge(d.skip(1).changes().map(function(){return!0})).combine(f,function(e,t){return e&&!t}).skipDuplicates().toProperty(),r.onValue(function(e){return!0===e?i.write("enabled_start",Date.now()):i.read("enabled_start",!1).then(function(e){if(e)return i.write("enabled_for",(Date.now()-e)/1e3),i.delete("enabled_start")}),i.write("enabled",e)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./force-premium":28,"./logged-in":39,"./options":41,"./popup":46,browser:9,page_api:44,storage:50}],27:[function(e,t,n){(function(n){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,o=e("storage"),i=e("./popup"),a=i.popup,s=e("auth"),u=e("./account"),c=u.user,l={malwareBlocking:"m",trackingProtection:"t"},d=r.fromEvent(a,"request:toggleMalware"),f=r.fromEvent(a,"request:toggleTracking"),p=r.fromPromise(o.read("features")).mapError(function(){return{}}).flatMap(function(e){return r.combineTemplate({malwareBlocking:d.startWith(e.malwareBlocking||!1),trackingProtection:f.startWith(e.trackingProtection||!1)}).combine(c,function(e,t){return t&&t.is_premium?e:{}})});t.exports=p,p.onValue(function(e){var t="";for(var n in e){e[n]&&(t+=l[n])}return s.setFeatureFlags(t),o.write("features",e)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./account":3,"./popup":46,auth:5,storage:50}],28:[function(e,t,n){(function(n){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,o=e("browser"),i=e("./popup"),a=i.popup,s=e("./account"),u=s.user,c=e("./util"),l=c.parseDate,d=e("./url-resolver"),f=o.getName(),p=["opera","yandex"].indexOf(f.toLowerCase())>-1,m=new Date(150177874e4),g=r.fromEvent(a,"request:popupOpen"),w=u.map(function(e){return e&&!e.is_premium&&p&&l(e.created_at)>m}).toProperty();g.filter(w).map(u).onValue(function(e){e.is_verified?o.openPage(d("account/premium-required",{utm_medium:"product",utm_source:"extension-tabspawn",utm_content:"premium-required"})):o.openPage(d("account/activate",{utm_medium:"product",utm_source:"extension-tabspawn",utm_content:"activate-premium"}))}),t.exports=w}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./account":3,"./popup":46,"./url-resolver":55,"./util":56,browser:9}],29:[function(e,t,n){(function(n){"use strict";function r(e){return e.replace("https","*")+"/*"}function o(e){return new URL(e).hostname}function i(e){return"*://"+e+"/*"}function a(e){f.write("fronting_domain",e),p.setApiURL("https://"+e),p.setNewsServiceUrl("https://"+e),p.setAuthApiDomain(e)}function s(e,t){var n=t.filter(function(t){return!e[t.name.toLowerCase()]});return Object.keys(e).forEach(function(t){n.push({name:t,value:e[t]})}),n}function u(){var e=h.map(i);chrome.webRequest.onBeforeSendHeaders.addListener(function(e){if(-1===e.tabId){var t=e.requestHeaders.filter(function(e){return"x-rm-url"===e.name}).reduce(function(e,t){return t.value},null),n=p.get().apiFront;t===p.get().newsServiceUrls[0]&&(n=p.get().newsServiceFront),e.requestHeaders.push({name:"Host",value:n})}return{requestHeaders:e.requestHeaders}},{urls:e,types:["xmlhttprequest"],tabId:-1},["requestHeaders","blocking"])}function c(t){if(!k){k=!0,a(t);var n=L.map(i),o=p.get().websiteDomains.map(function(e){return i("*."+e)}),u=n.concat(o);u.push(r(p.get().geoRedirector)),u.push(i(p.get().authApiDomains[0])),u.push(i(p.get().websiteAssets)),chrome.webRequest.onBeforeRequest.addListener(function(e){if(-1===e.tabId)return{};var n=new URL(e.url),r=n.hostname;"main_frame"===e.type&&(y[e.tabId]=r),n.hostname=t;var o=""+n.toString();return"main_frame"!==e.type&&(o=""+o+x+r),{redirectUrl:o}},{urls:u,types:v},["blocking"]),chrome.webRequest.onHeadersReceived.addListener(function(e){return y[e.tabId]?{responseHeaders:s({"access-control-allow-origin":"null","access-control-allow-credentials":"true","access-control-allow-headers":"content-type, Accept-Language, Authorization, xng-global-user-id","access-control-allow-methods":"GET, POST, PUT, PATCH, DELETE, OPTIONS","cache-control":"no-cache"},e.responseHeaders)}:{responseHeaders:e.responseHeaders}},{urls:[i(t)],types:["xmlhttprequest"]},["blocking","responseHeaders"]),chrome.webRequest.onBeforeSendHeaders.addListener(function(e){function n(n){return{requestHeaders:s({host:L.includes(n)?p.get().apiFront:p.get().websiteFront,"x-rm":"true","x-rm-host":n,"x-rm-front":t,"x-rm-main":r,"if-modified-since":"Thu, 01 Jan 1970 00:00:00 GMT"},e.requestHeaders)}}var r=y[e.tabId];if(!r)return{requestHeaders:e.requestHeaders};if(e.url.includes(x)){var o=void 0,i=e.url.match(/#x-rm-host=(.*)/i);if(i&&2===i.length&&(o=i[1]),o)return n(o)}return"main_frame"===e.type?n(r):b.includes(e.type)?n(p.get().websiteAssets):"xmlhttprequest"===e.type?n(L[0]):{requestHeaders:e.requestHeaders}},{urls:[i(t)],types:v},["requestHeaders","blocking"]),chrome.tabs.onUpdated.addListener(function(n,r){if(y[n]){if(r&&r.status&&"loading"===r.status)return!_.includes(n)&&["Chrome"].includes(m.getName())?void m.openPopup(r.url,function(e){var t=e.tabs[0];chrome.tabs.remove(n),_.push(t.id),y[t.id]=y[n],setTimeout(function(){chrome.tabs.reload(t.id)},25)}):void chrome.tabs.executeScript(n,{runAt:"document_start",code:'\n      document.documentElement.dataset.rm = "true";\n      document.documentElement.dataset.rmHost = "'+y[n]+'";\n      document.documentElement.dataset.rmFront = "'+t+'";\n\n      function modifyXHR() {\n        (function(open){\n          window.XMLHttpRequest.prototype.open = function (method, path, async) {\n            var url = new URL(path);\n            var host = url.hostname;\n            if (window.location.hostname !== url.hostname){\n              url.hostname = "'+t+'";\n              path = url.toString() + "'+x+"\" + host;\n            }\n            return open.apply(this, [].slice.call(arguments));\n          }\n        })(window.XMLHttpRequest.prototype.open);\n      }\n\n      var inject = '(' + modifyXHR + ')();';\n\n      var script = document.createElement('script');\n      script.innerHTML = inject;\n      var parent = document.body || document.head || document.documentElement;\n      parent.appendChild(script);\n\n      ("+e("./../content/page_api")+")();\n    "})}})}}function l(){return u(),new Promise(function(e){E.onValue(function(t){w({stickyFrontingDomain:t}).onValue(function(t){var n=t.online,r=t.apiUrl,o=t.frontingDomain;n&&(o?c(o):r&&p.setApiURL(r)),e()})})})}var d="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,f=e("./storage"),p=e("./config"),m=e("./browser"),g=e("./connectivity"),w=g.connectivityCheck,v=["main_frame","xmlhttprequest","image","script","stylesheet","font","object","other","ping"],b=["image","script","stylesheet","font"],h=JSON.parse(atob(p.get().domainFronts)),y={},_=[],x="#x-rm-host=",L=p.get().apiURLs.map(o),E=d.fromPromise(f.read("fronting_domain")).mapError(function(){return h[Math.floor(Math.random()*h.length)]}).toProperty(),k=!1,P=function(){return{fullFrontingEnabled:k}};t.exports={enableFronting:l,enableFullFronting:c,setFrontDomain:a,stickyFrontDomain:E,getFrontingState:P}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./../content/page_api":60,"./browser":9,"./config":11,"./connectivity":13,"./storage":50}],30:[function(e,t,n){(function(t){"use strict";var r=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=void 0,i="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,a=e("browser"),s=e("./tab-info"),u=e("./tab_state"),c=u.tabState,l=e("./logged-in"),d=e("./enabled"),f=e("./locations/current"),p=e("./rules"),m=p.rulesEnabled,g=e("./blocked"),w=g.proxyBlocked,v=e("./language"),b=v.messages,h=e("./account"),y=h.user,_=e("./crm/items/news"),x=e("./crm/items/tab_spawns"),L=e("./crm/items/popup");n.iconImage=i.combineAsArray(l,d.and(w.not()),c,m).onValues(function(e,t,n,r){return r&&n.isRuleActive&&n.isDirect?a.setIconImage("disabled"):e?t||r&&n.isRuleActive?a.setIconImage("enabled"):a.setIconImage("disabled"):a.setIconImage("signedOut")}),n.iconTitle=i.combineAsArray(l,d.and(w.not()),s,c,f,m,b).onValues(function(e,t,n,r,o,i,s){return i&&r.isRuleActive?a.setIconTitle(s.icon_hover.connected.replace("{host}",n.host).replace("{country}",o.country_name)):i&&r.isRuleActive&&r.isDirect?a.setIconTitle(s.icon_hover.disabled_smart):e?t?r.isLocal?a.setIconTitle(s.icon_hover.local):a.setIconTitle(s.icon_hover.connected.replace("{host}",n.host).replace("{country}",o.country_name)):a.setIconTitle(s.icon_hover.disabled):a.setIconTitle(s.icon_hover.signed_out)}),n.iconBadge=o=i.combineAsArray(s,c,f,m,y,_,x,L).map(function(e){var t=r(e,8),n=t[0],o=t[1],i=t[2],a=t[3],s=(t[4],t[5]),u=t[6],c=t[7];return a&&o.isRuleActive&&o.isDirect?["off",n.id]:a&&o.isRuleActive?[i.country_code.toLowerCase(),n.id]:s&&s.isNew&&s.showBadge||u||c?["1",n.id,"#CC3333"]:["",n.id]}),o.onValue(function(){var e=Array.from(arguments.length<=0?void 0:arguments[0]),t=r(e,3),n=t[0],o=t[1],i=t[2];return a.setIconBadge(n,o,i)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./account":3,"./blocked":7,"./crm/items/news":19,"./crm/items/popup":21,"./crm/items/tab_spawns":22,"./enabled":26,"./language":34,"./locations/current":35,"./logged-in":39,"./rules":48,"./tab-info":51,"./tab_state":52,browser:9}],31:[function(e,t,n){(function(t){"use strict";var n=(e("./config"),"undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null);e("./debug_overrides"),e("./install_source"),e("./logged-in"),e("./registration"),e("./crm/items/notifications"),e("./crm/items/context_notifications"),e("./crm/items/tab_spawns"),e("./icon_state"),e("./connect"),e("./widget"),e("./blocked_sites");var r=e("browser"),o=e("./language"),i=o.language,a=e("tab-info"),s=e("./tab_state"),u=s.tabState,c=e("./popup"),l=c.popup,d=e("./options"),f=d.options,p=e("./enabled"),m=e("page_api"),g=e("./account"),w=g.user,v=g.device,b=e("./locations"),h=e("./locations/default"),y=e("./locations/current"),_=e("./locations/favorite"),x=e("./crm/items/news"),L=e("./crm/items/popup"),E=e("./features"),k=e("./rules"),P=k.rules,A=k.rulesEnabled,S=e("./url-resolver"),C=e("blocked"),I=C.proxyBlocked,R=C.proxyBlockedBy,O=e("./smart_price"),j=e("./connectivity"),D=j.connectivityCheck,T=e("./fronting"),M=T.getFrontingState,B=T.stickyFrontDomain,z=n.combineTemplate({user:w,device:v,news:x,crmPopUp:L,language:i,features:E,tabInfo:a,tabState:u,locations:b,currentLocation:y,defaultLocation:h,favoriteLocations:_,enabled:p,rules:P,rulesEnabled:A,proxyBlocked:I,proxyBlockedBy:R,smartPrice:O});z.onValue(function(e){return window.popupData=e}),z.changes().debounce(25).onValue(function(e){return l.send("response:data",e)}),n.fromEvent(m,"request:getData").flatMapLatest(function(e){return n.combineAsArray(e,w,v).take(1)}).onValues(function(e,t,n){return m.send("response:getData",e._sender,{timestamp:e.timestamp,user:t,device:n})}),n.fromEvent(l,"request:openPage").map(function(e){return S(e.url,e.params)}).onValue(r.openPage),n.fromEvent(l,"request:unblockProxySettings").onValue(function(){return r.unblockProxySettings()});var U=n.combineTemplate({user:w,device:v,enabled:p,currentLocation:y}).startWith({});n.fromEvent(f,"request:data").map(B).flatMapLatest(function(e){return D({stickyFrontingDomain:e})}).flatMapLatest(function(e){return n.combineTemplate({data:U,connectivity:e,fronting:M()})}).onValue(function(e){return f.send("response:data",e)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./account":3,"./blocked_sites":8,"./config":11,"./connect":12,"./connectivity":13,"./crm/items/context_notifications":18,"./crm/items/news":19,"./crm/items/notifications":20,"./crm/items/popup":21,"./crm/items/tab_spawns":22,"./debug_overrides":24,"./enabled":26,"./features":27,"./fronting":29,"./icon_state":30,"./install_source":33,"./language":34,"./locations":38,"./locations/current":35,"./locations/default":36,"./locations/favorite":37,"./logged-in":39,"./options":41,"./popup":46,"./registration":47,"./rules":48,"./smart_price":49,"./tab_state":52,"./url-resolver":55,"./widget":58,blocked:7,browser:9,page_api:44,"tab-info":51}],32:[function(e,t,n){(function(n){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,o=e("storage"),i=e("./util"),a=e("./api_request"),s=a.apiRequest,u=r.fromPromise(o.read("install_id")).flatMapError(function(){var e=i.generateInstallId();return s("et/install/download","GET",{install_id:e}).map(e).mapError(e)}).toProperty();u.onValue(function(e){return o.write("install_id",e)}),t.exports=u}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./api_request":4,"./util":56,storage:50}],33:[function(e,t,n){(function(n){"use strict";var r=void 0,o="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,i=e("storage"),a=e("browser");e("./util"),e("loglevel");t.exports=r=o.fromPromise(i.read("install_source")).flatMapError(function(e){return o.fromCallback(function(e){return a.getInstallSource(e)})}).toProperty(),r.onValue(function(e){return i.write("install_source",e)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util":56,browser:9,loglevel:1,storage:50}],34:[function(e,t,n){(function(r){"use strict";var o=void 0,i="undefined"!=typeof window?window.Bacon:void 0!==r?r.Bacon:null,a=e("browser"),s=e("storage"),u=e("./popup"),c=u.popup,l="undefined"!=typeof window?window.locales:void 0!==r?r.locales:null;n.language=o=i.fromPromise(s.read("language")).mapError(function(){return a.getLocale()}).merge(i.fromEvent(c,"request:changeLanguage")).skipDuplicates().toProperty(),t.exports.messages=o.map(function(e){return l.getLocalization(e).messages}),o.onValue(function(e){return s.write("language",e)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./popup":46,browser:9,storage:50}],35:[function(e,t,n){(function(n){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,o=e("../tab_state"),i=o.tabState,a=e("../rules"),s=a.rulesEnabled,u=e("./index"),c=e("./default"),l=r.combineTemplate({tabState:i,rulesEnabled:s,defaultLocation:c,locations:u}).map(function(e){var t=e.tabState,n=e.rulesEnabled,r=e.defaultLocation,o=e.locations;return n&&t.isRuleActive?t.isDirect?{country_code:"OFF",location:"ZenMate Off"}:o.find(function(e){return e.country_code===t.customCountry})||r:r});t.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../rules":48,"../tab_state":52,"./default":36,"./index":38}],36:[function(e,t,n){(function(n){"use strict";function r(e,t){return e.nodes&&e.nodes.length&&(!e.premium_only||t.is_premium)}var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{
for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,a=e("storage"),s=e("browser"),u=e("../popup"),c=u.popup,l=e("../account"),d=l.user,f=e("./index"),p=e("./favorite"),m=s.notificationEvents.filter(function(e){return e.event.startsWith("enableLocation")}).map(function(e){var t=e.event;return t.startsWith("enableLocationAndRefresh")&&setTimeout(function(){return chrome.tabs.reload()},250),t.split(":")[1]}),g=i.fromPromise(a.read("default_location")).mapError(function(){return"not_a_cc"}).merge(i.fromEvent(c,"request:changeLocation")).merge(m).skipDuplicates().combine(i.combineAsArray(f,p,d),function(e,t){var n=o(t,3),i=n[0],a=n[1],s=n[2];if(!i)return null;var u=i.find(function(t){return t.country_code===e&&r(t,s)});return u||(u=i.find(function(e){return r(e,s)})),u?(a.includes(u.country_code)?u.isFavorite=!0:delete u.isFavorite,u):null}).filter(function(e){return e}).toProperty();g.onValue(function(e){a.write("default_location",e.country_code)}),t.exports=g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../account":3,"../popup":46,"./favorite":37,"./index":38,browser:9,storage:50}],37:[function(e,t,n){(function(n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e){return function(t){return[].concat(r(t),r(e))}}function i(e){return function(t){return t.includes(e)?[].concat(r(t)):[].concat(r(t),[e])}}function a(e){return function(t){return t.filter(function(t){return t!==e})}}var s="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,u=e("storage"),c=e("../popup"),l=c.popup,d=s.fromPromise(u.read("favorite_locations")).mapError(function(){return[]}),f=s.fromEvent(l,"request:addFavoriteLocation"),p=s.fromEvent(l,"request:removeFavoriteLocation"),m=s.when([d],o,[f],i,[p],a).scan([],function(e,t){return t(e)});m.onValue(function(e){u.write("favorite_locations",e)}),t.exports=m}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../popup":46,storage:50}],38:[function(e,t,n){(function(n){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,o=e("storage"),i=e("../registration"),a=i.signIn,s=i.signOut,u=e("../popup"),c=u.popup,l=e("../update"),d=r.fromPromise(o.read("custom_locations")).mapError(function(){return[]}).concat(r.fromEvent(c,"request:addCustomLocation").map(function(e){return[e]})).filter(function(e){return e}).scan([],".concat");d.onValue(function(e){return o.write("custom_locations",e)});var f=r.fromPromise(o.read("default_locations")).skipErrors().merge(a.merge(l).map(function(e){return e.locations})).filter(function(e){return e&&e.length}).merge(s.map(function(){return[]})).toProperty();f.onValue(function(e){return e?o.write("default_locations",e):o.delete("default_locations")}),t.exports=f}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../popup":46,"../registration":47,"../update":54,storage:50}],39:[function(e,t,n){(function(n){"use strict";var r=e("browser"),o="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,i=e("./registration"),a=i.signIn,s=i.signOut,u=o.fromPromise(r.setup());u.onValue(function(e){return!e&&r.openSignupPage()});var c=u.merge(a.map(function(){return!0}).mapError(function(){return!1})).merge(s.map(function(){return!1})).skipDuplicates().toProperty();c.onValue(function(e){return r.setIconAction(e?"popup":"")}),t.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./registration":47,browser:9}],40:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./emitter"),u=(e("loglevel"),function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.name=e,n.port=null,chrome.runtime.onConnect.addListener(function(e){if(e.name===n.name){var t=n.port&&n.port.sender&&n.port.sender.tab&&n.port.sender.tab.id,r=e&&e.sender&&e.sender.tab&&e.sender.tab.id;return t&&r&&t!==r&&chrome.tabs.remove(n.port.sender.tab.id),n.port=e,n.port.onMessage.addListener(function(e){return n.trigger(e.subject,e.payload)}),n.port.onDisconnect.addListener(function(e){n.port=null})}}),n}return i(t,e),a(t,[{key:"send",value:function(e,t){try{this.port&&this.port.postMessage({subject:e,payload:t})}catch(e){return}}}]),t}(s));t.exports=u},{"./emitter":25,loglevel:1}],41:[function(e,t,n){"use strict";var r=e("message_handler");n.options=new r("options")},{message_handler:40}],42:[function(e,t,n){"use strict";var r=e("../config"),o=e("../util"),i={localDomains:r.get().localDomains,nodeOverrides:r.get().nodeOverrides,IPv4NotationRE:/^\d+\.\d+\.\d+\.\d+$/g,localIPsRE:/(^127\.)|(^192\.168\.)|(^10\.)|(^172\.1[6-9]\.)|(^172\.2[0-9]\.)|(^172\.3[0-1]\.)/};t.exports={data:i,mergeRuleOverrides:function(e,t){if(!((e?e.length:void 0)>0))return[];if(!((t?t.length:void 0)>0))return e;var n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var u=a.value,c=!0,l=!1,d=void 0;try{for(var f,p=t[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var m=f.value;m.domains.indexOf(u.domain)>-1&&(u.hosts=o.concatUnique(u.hosts||[],m.hosts||[]))}}catch(e){l=!0,d=e}finally{try{!c&&p.return&&p.return()}finally{if(l)throw d}}}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}return e},nodeLookup:function(e,t){return e[t]||!1},compareHosts:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(this.matchWildcardDomain(t,s))return s}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}},compareURLs:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(s.test(t))return s}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}},dnsDomainIs:function(e,t){return e.length>=t.length&&e.substring(e.length-t.length)===t},matchWildcardDomain:function(e,t){var n=e===t,r=e.slice(-t.length)===t,o="."===e[e.lastIndexOf(t)-1];return n||r&&o},matchNodeOverride:function(e,t){var n=this,r=this.data.nodeOverrides.find(function(r){return r.target_cc===t&&n.compareHosts(r.hosts,e)});return!!r&&r.nodes},matchRules:function(e,t,n){if(e&&e.length){this.data.rulesWithOverrides||(e=this.mergeRuleOverrides(e,r.get().ruleOverrides));for(var o=0;o<e.length;o++){var i=e[o];if(this.matchWildcardDomain(t,i.domain)||i.hosts&&this.compareHosts(i.hosts,t))return o}}},_getProxyState:function(e,t,n){if(e=e.toLowerCase(),this.data.IPv4NotationRE.lastIndex=0,this.data.localIPsRE.lastIndex=0,!~t.indexOf(".")&&!~t.indexOf(":"))return"LOCAL";if(this.data.IPv4NotationRE.test(t)&&this.data.localIPsRE.test(t))return"LOCAL";var r=!0,o=!1,i=void 0;try{for(var a,s=this.data.localDomains[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(this.matchWildcardDomain(t,u))return"LOCAL"}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}var c=this.matchRules(n,t,e);return Number.isInteger(c)?n[c].cc:"DEFAULT"}}},{"../config":11,"../util":56}],43:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=e("../config"),i=e("../util"),a=e("./engine"),s=(e("loglevel"),function(e){e=e||a;var t=[],n=!0,o=!1,i=void 0;try{for(var s,u=Object.keys(e)[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var c=s.value,l=e[c];switch(r(e[c])){case"function":t.push(c+": "+l.toString());break;case"object":t.push(c+": "+JSON.stringify(e[c]))}}}catch(e){o=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return"{ "+t.join(",")+" }"}),u="e.data.IPv4NotationRE = "+a.data.IPv4NotationRE.toString()+";\ne.data.localIPsRE = "+a.data.localIPsRE.toString()+";";n.exportPAC=function(e,t,n,r){return n=n||[],r=r||[],"/*ZenMate*/\nfunction FindProxyForURL(url, host) {\n\n  var e = "+s()+";\n  e.data.localDomains = e.data.localDomains.concat("+JSON.stringify(r)+");\n  "+u+"\n\n  e.data.defaultLocation = '"+e+"';\n  e.data.nodeDict = "+JSON.stringify(t)+";\n  e.data.rulesWithOverrides = "+JSON.stringify(a.mergeRuleOverrides(n,o.get().ruleOverrides))+";\n\n  var res = e._getProxyState(url, host, e.data.rulesWithOverrides);\n  var cc;\n  if (res === 'LOCAL' || res === 'DIRECT' || res === 'OFF') {return 'DIRECT'};\n  if (res === 'DEFAULT') {cc = e.data.defaultLocation} else {cc = res};\n  var override = e.matchNodeOverride(host, cc);\n  if (override) {cc = override};\n  return e.nodeLookup(e.data.nodeDict, cc) || 'DIRECT';\n}"},n.getProxyStateByURL=function(e,t,n){return n=n||[],t=t||i.parseURL(e).host||e,a._getProxyState(e,t,n)},n.getNodeDictFromLocations=function(e,t,n){e=e.concat(o.get().alternativeNodes);var r={},i=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var l=u.value,d=l.nodes.slice(0,15).map(function(e){var t=e.replace("node.zenmate.io","zenguard.org").replace("node.zenguard.co","zenguard.co");return n?t:"HTTPS "+t+":443"});r[l.country_code]=d.join(";")}}catch(e){a=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw s}}return r},n.matchRules=function(e,t,n){return a.matchRules(e,t,n)}},{"../config":11,"../util":56,"./engine":42,loglevel:1}],44:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./emitter"),u=(e("loglevel"),function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return chrome.runtime.onMessage.addListener(function(t,n){if(t&&t.subject)return t.payload||(t.payload={}),t.payload._sender=n,e.trigger(t.subject,t.payload)}),e}return i(t,e),a(t,[{key:"send",value:function(e,t,n){return chrome.tabs.sendMessage(t.tab.id,{subject:e,payload:n})}}]),t}(s));t.exports=new u},{"./emitter":25,loglevel:1}],45:[function(e,t,n){(function(n){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,o=e("page_api"),i=["zenmate.com","d1jr1idae5ms9n.cloudfront.net"];t.exports=r.interval(18e5,i).merge(r.fromEvent(o,"setPageExcludes").map(function(e){return i.concat(e)})).toProperty(i)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{page_api:44}],46:[function(e,t,n){"use strict";var r=e("message_handler");n.popup=new r("popup")},{message_handler:40}],47:[function(e,t,n){(function(t){"use strict";var r=void 0,o="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,i=e("./api_request"),a=i.apiRequest,s=e("./popup"),u=s.popup,c=e("./install_source"),l=e("browser"),d=e("./update"),f=(e("storage"),e("page_api")),p=e("./language"),m=p.messages,g=e("cookie"),w=o.fromEvent(u,"request:signOut");w.onValue(function(){return g.removeAuthCookie()}),n.signOut=r=w.merge(o.fromEvent(f,"removeCredentials")).merge(d.errors().mapError(function(e){return 403===e.error.status}).filter(function(e){return e})),r.map(m.toProperty()).onValue(function(e){var t=e.notifications.logout,n={type:"basic",title:t.title,message:t.message},r={title:t.title,text:t.message};return l.notify({chrome:{newsItem:n},firefox:r}),l.closePopup()}),n.signIn=o.fromEvent(f,"updateWithCredentials").flatMapLatest(function(e){return o.combineTemplate({install_source:c,data:e})}).flatMapLatest(function(e){var t=e.install_source,n=e.data;return n.install_source=t,a("sign_in","POST",n)}).flatMapError(function(e){return o.fromPromise(new Promise(function(t,n){return n("onload"!==e.type?e:403==+e.status?Error("errors.user.unknown_email_password"):422==+e.status?Error(e.payload.error_codes[e.payload.error_codes.length-1]):Error("errors.unknown"))}))})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./api_request":4,"./install_source":33,"./language":34,"./popup":46,"./update":54,browser:9,cookie:14,page_api:44,storage:50}],48:[function(e,t,n){(function(t){"use strict";var r=void 0,o=void 0,i="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,a=e("storage"),s=e("./popup"),u=s.popup,c=e("./account"),l=c.user;n.rules=r=i.fromPromise(a.read("rules")).mapError(function(){return[]}).merge(i.fromEvent(u,"request:updateRules")).filter(function(e){return e}).toProperty(),r.onValue(function(e){return a.write("rules",e)}),n.rulesEnabled=o=i.fromPromise(a.read("rules_enabled")).mapError(function(){return!1}).merge(i.fromEvent(u,"request:toggleRules")).combine(l,function(e,t){return t&&t.is_premium&&e}).skipDuplicates().toProperty(),o.onValue(function(e){return a.write("rules_enabled",e)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./account":3,"./popup":46,storage:50}],49:[function(e,t,n){(function(n){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,o=e("storage"),i=e("./popup"),a=i.popup,s=e("ciuvo_messages"),u=e("./account"),c=u.user,l=c.filter(function(e){return e}).flatMapLatest(function(e){return r.fromPromise(o.read("disable_smartprice")).flatMapError(function(){return e.is_premium}).map(function(e){return!e}).merge(r.fromEvent(s,"disableSmartPrice").map(function(){return o.write("disable_smartprice",!0),!1})).merge(r.fromEvent(a,"request:switchSmartPrice").map(function(e){return o.write("disable_smartprice",!e),e}))});t.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./account":3,"./popup":46,ciuvo_messages:10,storage:50}],50:[function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.read=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise(function(n,r){return chrome.storage.local.get(e,function(o){o.hasOwnProperty(e)?n(o[e]):t?r(Error("Element "+e+" not found")):n()})})},n.write=function(e,t){return new Promise(function(n){var o=r({},e,t);return chrome.storage.local.set(o,n)})},n.delete=function(e){return new Promise(function(t){return chrome.storage.local.remove(e,t)})}},{}],51:[function(e,t,n){(function(n){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,o=e("./util"),i=r.fromBinder(function(e){chrome.tabs.query({active:!0},function(t){t&&t.length&&e(t[0])}),chrome.tabs.onActivated.addListener(function(t){chrome.tabs.get(t.tabId,e)}),chrome.tabs.onUpdated.addListener(function(t,n,r){r.active&&"complete"!==n.status&&r&&e(r)})}).diff(null,function(e,t){var n=t.url.includes("chrome-devtools://devtools");return t&&e&&n?null:t}).filter(function(e){return e}).map(function(e){return e.host=o.parseURL(e.url).host,e.favIconUrl=e.favIconUrl||"chrome://favicon/"+e.url,e}).toProperty();t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util":56}],52:[function(e,t,n){(function(t){"use strict";var r="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,o=e("./util"),i=e("./rules"),a=i.rules,s=e("tab-info"),u=e("./pacengine"),c=function(e,t){var n=o.parseURL(e.url),r=u.getProxyStateByURL(e.url,n.host,t),i={isDefault:"DEFAULT"===r,isLocal:"LOCAL"===r,isDirect:"OFF"===r};return i.isRuleActive=!(i.isDefault||i.isLocal),i.isRuleActive&&!i.isDirect&&(i.customCountry=r),i};n.tabState=r.combineTemplate({tabInfo:s,rules:a}).map(function(e){var t=e.tabInfo,n=e.rules;if(t)return c(t,n)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./pacengine":43,"./rules":48,"./util":56,"tab-info":51}],53:[function(e,t,n){"use strict";var r=e("browser"),o=e("./url-resolver"),i=e("./account"),a=i.user,s=e("./util"),u=s.parseDate;n.showTrialEndTab=a.flatMapLatest(function(e){if(e){var t={utm_medium:"product",utm_source:"extension-tabspawn",utm_campaign:"premium-promotion"},n=o("account/premium",t),r=u(e.premium_expires_at||e.created_at);if(e.is_premium&&!e.has_recurring_subscription){var i=new Date;if(i.setDate(i.getDate()+1),r<i)return{url:n,id:"premium_end_promo"}}if(!e.is_premium){var a=new Date;a.setDate(a.getDate()-7);var s=new Date;s.setDate(s.getDate()-14);var c=new Date;c.setDate(c.getDate()-30);var l=new Date;l.setDate(l.getDate()-37);var d=new Date;if(d.setDate(d.getDate()-40),s<r&&r<a)return{url:n,id:"premium_end_promo2"};if(l<r&&r<c)return{url:n,id:"premium_end_promo3"};if(d<r&&r<l)return{url:n,id:"premium_end_promo4"}}}});var c=a.map(function(e){if(e&&!e.has_recurring_subscription){var t=u(e.premium_expires_at||e.created_at),n=new Date;n.setDate(n.getDate()+1);var r=new Date;r.setDate(r.getDate()-9);var o=new Date;o.setDate(o.getDate()-30);var i=new Date;return i.setDate(i.getDate()-40),r<t&&t<n||i<t&&t<o}});n.showTrialEndNews=c.flatMapLatest(function(e){var t={utm_medium:"product",utm_source:"extension-banner",utm_campaign:"premium-promotion"},n=o("account/premium",t),i=r.getLocale().toUpperCase();if(e)return{text:"!["+n+"](images/tabspawn/tabspawn-"+i+".gif)",id:"premium_end_promo"}})},{"./account":3,"./url-resolver":55,"./util":56,browser:9}],54:[function(e,t,n){(function(n){"use strict";var r=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o="undefined"!=typeof window?window.Bacon:void 0!==n?n.Bacon:null,i=e("./api_request"),a=i.apiRequestWithAuth,s=e("./install_id"),u=e("page_api"),c=e("storage");t.exports=o.once().delay(1e3).merge(o.interval(12e5)).merge(o.fromEvent(u,"update")).flatMap(function(){return o.combineAsArray(s.take(1),o.fromPromise(c.read("enabled_for",!1)))}).flatMapLatest(function(e){var t=r(e,2),n=t[0],o=t[1];return a("devices/"+n,"GET",{enabled_for:o})})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./api_request":4,"./install_id":32,page_api:44,storage:50}],55:[function(e,t,n){"use strict";function r(e,t){return"https://geo.zenmate.com/"+e+"."+l+(t?"?"+t:"")}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=void 0,o=e.split("?"),a=i(o,2),s=a[0],u=a[1],c=Object.keys(t).map(function(e){return e+"="+t[e]}),l=c.join("&");return l=l&&u?l+"&"+u:u||l,n=e.includes("://")?s+(l?"?"+l:""):r(s,l),n=n.replace("{countryCode}",d)}var i=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("./language"),s=a.language,u=e("./account"),c=u.user,l="en",d="unknown";s.onValue(function(e){return l=e}),c.filter(function(e){return e}).onValue(function(e){return d=e.country_code}),t.exports=o},{"./account":3,"./language":34}],56:[function(e,t,n){"use strict";var r=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();n.generateInstallId=function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},n.parseURL=function(e){var t=void 0,n=/^([^:]+):\/\/([^\/:]*)(?::([\d]+))?(?:(\/[^#]*)(?:#(.*))?)?$/i,r=e.match(n);return r?{scheme:r[1].toLowerCase(),host:r[2].toLowerCase(),port:r[3],path:r[4]||"/",fragment:r[5],local:(t=r[1].toLowerCase(),!["http","https"].includes(t))}:{}},n.getUTMSourcesFromURL=function(e){for(var t=void 0,r=n.parseURL(e),o=r.path,i=/[?&]([^=#]+)=([^&#]*)/g,a=[];t=i.exec(o);)0===t[1].indexOf("utm_")&&a.push(t[1]+"="+t[2]);return a.join(";")},n.concatUnique=function(e,t){return e.concat(t).filter(function(e,t,n){return n.indexOf(e)===t})},n.parseDate=function(e){var t=new Date(e);if(isNaN(t.getTime())){var n=e.split(" "),o=r(n,2),i=o[0],a=o[1],s=i.split("-"),u=a.split(":");return new Date(s[0],s[1]-1,s[2],u[0],u[1],u[2])}return t},n.shuffle=function(e){for(var t=e.length,n=null,r=null;0!==t;)r=Math.floor(Math.random()*t),t--,n=e[t],e[t]=e[r],e[r]=n;return e},n.chunk=function(e,t){t=t<=0?1:t;for(var n=[],r=0,o=e.length;r<o;)n.push(e.slice(r,r+=t));return n},n.isChrome="undefined"==typeof browser},{}],57:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("./emitter"),u=chrome.extension.getURL(""),c=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.active=!1,e.showMessage=!0,e.messages=null,chrome.runtime.onMessage.addListener(function(t,n){"getWidgetStatus"===t.subject&&chrome.tabs.sendMessage(n.tab.id,{subject:"widgetStatus",payload:{active:e.active,extUrl:u}}),"getWidgetMessage"===t.subject&&chrome.tabs.sendMessage(n.tab.id,{subject:"widgetMessage",payload:{show:e.showMessage,extUrl:u,messages:e.messages}}),"dismiss"!==t.subject&&"hideMessage"!==t.subject||e.trigger(t.subject,n),"getPremium"===t.subject&&e.trigger(t.subject,t.payload)}),e}return i(t,e),a(t,[{key:"toggle",value:function(e){e!==this.active&&chrome.tabs.query({},function(t){return Array.from(t).map(function(t){return chrome.tabs.sendMessage(t.id,{subject:"widgetStatus",payload:{active:e,extUrl:u}})})}),this.active=e}},{key:"toggleMessage",value:function(e,t){this.messages=t,this.showMessage=e,chrome.tabs.query({},function(n){return Array.from(n).map(function(n){return chrome.tabs.sendMessage(n.id,{subject:"widgetMessage",payload:{show:e,extUrl:u,messages:t}})})})}}]),t}(s);t.exports=new c},{"./emitter":25}],58:[function(e,t,n){(function(t){"use strict";var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r="undefined"!=typeof window?window.Bacon:void 0!==t?t.Bacon:null,o=e("browser"),i=e("widget-messages"),a=e("storage"),s=e("./url-resolver"),u=e("./crm"),c=e("./account"),l=c.user,d=e("./language"),f=d.messages,p=e("./enabled"),m=o.getName(),g=["opera","yandex"].indexOf(m&&m.toLowerCase())>-1;r.fromPromise(a.read("widget_last_shown")).mapError(function(){return 0}).flatMapLatest(function(e){return r.later(Math.max(864e5+e-Date.now(),6e4),!0)}).merge(r.interval(864e5,!0)).merge(r.fromEvent(i,"getPremium").doAction(function(e){var t=e.url;t||(t=s("account/premium",{utm_medium:"product",utm_source:"extension-widget",utm_campaign:"premium-promotion"})),g&&(t=s("account/order",{utm_medium:"product",utm_source:"extension-widget",utm_campaign:"premium-promotion"})),o.openPage(t)}).map(!1)).merge(r.fromEvent(i,"dismiss").map(!1)).toProperty().flatMapLatest(function(e){return r.combineAsArray(e,l,p)}).onValues(function(e,t,n){g?i.toggle(e&&t&&!t.is_premium):i.toggle(e&&t&&!t.is_premium&&n),e&&a.write("widget_last_shown",Date.now())});var w=r.combineTemplate({user:l,messages:f,crm:u}).map(function(e){var t=e.user,r=e.messages,o=e.crm,i=g?"forcePremium":t&&t.is_verified?"verified":"unverified";return n({},r.widget[i],o.widget)}).toProperty();r.once(!0).merge(r.interval(864e5,!0)).merge(r.fromEvent(i,"hideMessage").map(!1)).combine(w,function(e,t){return[e,t]}).onValues(function(e,t){return i.toggleMessage(e,t)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./account":3,"./crm":17,"./enabled":26,"./language":34,"./url-resolver":55,browser:9,storage:50,"widget-messages":57}],59:[function(e,t,n){"use strict";var r=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("ua-parser-js"),i=e("storage"),a=function(){return Promise.all([i.read("install_id",!1),i.read("install_source",!1),i.read("enabled",!1),i.read("default_location",!1),i.read("user",!1),i.read("device",!1)]).then(function(e){var t=r(e,6),n=t[0],i=t[1],a=t[2],s=t[3],u=t[4],c=t[5],l=new o(navigator.userAgent).getResult();return{real_location:u&&u.country_code,uuid:c&&c.uuid,platform_name:"extension",client_name:l.browser.name,user_agent_string:l.ua,client_env:l.ua,isPremium:u&&u.is_premium,isVerified:u&&u.is_verified,isAnonymous:u&&u.is_anonymous,zm_connected:a,selected_location:s,sku:u&&u.subscription&&u.subscription.sku,install_source:i,install_id:n,os_name:l.os.name,os_ver:l.os.version,client_ver:chrome.runtime.getManifest().version,app_ver:chrome.runtime.getManifest().version,locations_scope:"full",show_premium:!0}})};n.request=function(e){return a().then(function(t){var n=void 0,r={};for(var o in t)(n=t[o])&&(r[o]=n);for(o in e.data)n=e.data[o],r[o]=n;return new Promise(function(t,n){var o=void 0,i=void 0,a=void 0,s=void 0,u=new XMLHttpRequest,c=e.method||"GET",l="";"GET"===c.toUpperCase()&&e.data&&(o=function(){var e=[];for(a in r)s=r[a],e.push(encodeURIComponent(a)+"="+encodeURIComponent(s));return e}(),l="?"+o.join("&")),u.open(c,e.url+l),u.responseType=e.responseType||"";for(a in e.headers)s=e.headers[a],u.setRequestHeader(a,s);var d=null;if(i=c.toUpperCase(),["POST","PUT"].includes(i)&&e.data){d=new FormData;for(a in r)s=r[a],d.append(a,s)}return u.onload=function(){if(u.status>=200&&u.status<300)return u.payload=u.response,t(u);var e=Error("Error");return e.type="onload",e.payload=u.response,e.status=u.status,n(e)},u.onerror=function(){var e=Error("Network Error");return e.type="onerror",e.payload=u.response,e.status=u.status,n(e)},u.ontimeout=function(){var e=Error("Request timeout");return e.type="ontimeout",n(e)},u.send(d)})})}},{storage:50,"ua-parser-js":2}],60:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,n){"object"===(void 0===t?"undefined":r(t))&&t.exports?t.exports=n:n()}(0,function(){function e(){window.__zm={toggle:function(e){document.dispatchEvent(new CustomEvent("toggle",{detail:e}))},setPageExcludes:function(e){document.dispatchEvent(new CustomEvent("setPageExcludes",{detail:e}))},update:function(){document.dispatchEvent(new CustomEvent("updateZM"))},removeCredentials:function(){document.dispatchEvent(new CustomEvent("removeCredentials"))},updateWithCredentials:function(e){document.dispatchEvent(new CustomEvent("updateWithCredentials",{detail:e}))},getData:function(e){ts=Date.now(),document.dispatchEvent(new CustomEvent("request:getData",{detail:ts})),document.addEventListener("response:getData",function(t){if(t.detail.timestamp===ts&&e)return e({user:t.detail.user,device:t.detail.device})})}}}var t="("+e+")();";document.addEventListener("toggle",function(e){chrome.runtime.sendMessage({subject:"toggle",payload:e.detail})}),document.addEventListener("setPageExcludes",function(e){chrome.runtime.sendMessage({subject:"setPageExcludes",payload:e.detail})}),document.addEventListener("updateZM",function(e){chrome.runtime.sendMessage({subject:"update"})}),document.addEventListener("removeCredentials",function(e){chrome.runtime.sendMessage({subject:"removeCredentials"})}),document.addEventListener("updateWithCredentials",function(e){chrome.runtime.sendMessage({subject:"updateWithCredentials",payload:e.detail})}),document.addEventListener("request:getData",function(e){chrome.runtime.sendMessage({subject:"request:getData",payload:{timestamp:e.detail}})}),chrome.runtime.onMessage.addListener(function(e,t){e&&e.subject&&document.dispatchEvent(new CustomEvent(e.subject,{detail:e.payload}))});var n=document.createElement("script");n.innerHTML=t,(document.body||document.head||document.documentElement).appendChild(n)})},{}]},{},[31]);