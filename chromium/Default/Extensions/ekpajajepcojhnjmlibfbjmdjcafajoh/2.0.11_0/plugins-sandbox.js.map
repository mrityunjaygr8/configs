{"version":3,"sources":["webpack:///webpack/bootstrap 4bb4bb3f90d827a53581","webpack:///./src/extension/plugins-sandbox.js"],"names":["logger","window","console","log","pluginSandbox","parsers","youtubeApiKey","init","addEventListener","event","data","messageSource","source","messageOrigin","origin","type","loadScript","getNext","id","parseResult","error","message","audius","vuex","includes","Object","assign","mediaList","postMessage","result","getUrl","options","code","eval","responseTemplate"],"mappings":"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","file":"plugins-sandbox.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 336);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 4bb4bb3f90d827a53581","const logger = window.console.log;\n\n/* eslint-disable no-eval */\nconst pluginSandbox = {\n\tparsers: {},\n\tyoutubeApiKey: '',\n\tinit() {\n\t\twindow.addEventListener('message', event => {\n\t\t\tlogger('## sandbox event', event.data);\n\t\t\tif (!this.messageSource) {\n\t\t\t\tlogger('## sandbox handshake complete');\n\t\t\t\tthis.messageSource = event.source;\n\t\t\t\tthis.messageOrigin = event.origin;\n\t\t\t}\n\t\t\tif (event.data.type === 'loadScript') this.loadScript(event.data);\n\t\t\telse if (event.data.type === 'getNext') this.getNext(event.data.id);\n\t\t\telse if (event.data.id in this.parsers && event.data.type in this.parsers[event.data.id]) {\n\t\t\t\tlet parseResult;\n\t\t\t\ttry {\n\t\t\t\t\tparseResult = this.parsers[event.data.id][event.data.type](event.data.data);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tthis.message({\n\t\t\t\t\t\taudius: true,\n\t\t\t\t\t\tvuex: 'commit',\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tdata: `Error parsing ${event.data.id}. ${error}`,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (['getYouTubeInfo', 'scanOneUrl', 'ajaxRaw', 'ajaxJSON'].includes(parseResult.type)) {\n\t\t\t\t\tthis.message(\n\t\t\t\t\t\tObject.assign(parseResult, { id: event.data.id, youtubeApiKey: this.youtubeApiKey })\n\t\t\t\t\t);\n\t\t\t\t} else if (parseResult.type === 'mediaList') {\n\t\t\t\t\tthis.message({\n\t\t\t\t\t\taudius: true,\n\t\t\t\t\t\tvuex: 'dispatch',\n\t\t\t\t\t\ttype: 'webScraperUpdateSuccess',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tid: event.data.id,\n\t\t\t\t\t\t\tmediaList: parseResult.data,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t} else if (parseResult.type === 'noop') {\n\t\t\t\t\t// Don't do anything, relax.\n\t\t\t\t} else {\n\t\t\t\t\tthis.message({\n\t\t\t\t\t\taudius: true,\n\t\t\t\t\t\tvuex: 'commit',\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tdata: `Unknown plugin command ${parseResult[0]}.`,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\n\tmessage(data) {\n\t\tthis.messageSource.postMessage(data, this.messageOrigin);\n\t},\n\tgetNext(id) {\n\t\ttry {\n\t\t\tconst result = this.parsers[id].getUrl();\n\t\t\tthis.message(Object.assign(result, { id })); // parser calls getJSON\n\t\t} catch (error) {\n\t\t\tthis.message({\n\t\t\t\taudius: true,\n\t\t\t\tvuex: 'commit',\n\t\t\t\ttype: 'error',\n\t\t\t\tdata: `Error getting next page. ${error}`,\n\t\t\t});\n\t\t}\n\t},\n\tloadScript(options) {\n\t\tconst { id, code, youtubeApiKey } = options;\n\t\tif (this.parsers[id])\n\t\t\tthis.message({\n\t\t\t\taudius: true,\n\t\t\t\tvuex: 'commit',\n\t\t\t\ttype: 'error',\n\t\t\t\tdata: `Script '${id}' is already loaded`,\n\t\t\t});\n\t\ttry {\n\t\t\tthis.parsers[id] = eval(code);\n\t\t\tif (options.responseTemplate) this.message(options.responseTemplate);\n\t\t\tthis.youtubeApiKey = youtubeApiKey;\n\t\t\tthis.getNext(id);\n\t\t} catch (error) {\n\t\t\tthis.message({\n\t\t\t\taudius: true,\n\t\t\t\tvuex: 'commit',\n\t\t\t\ttype: 'error',\n\t\t\t\tdata: `Error loading script. ${error}`,\n\t\t\t});\n\t\t}\n\t},\n};\n\nlogger('# Plugin sandbox');\npluginSandbox.init();\n\n\n\n// WEBPACK FOOTER //\n// ./src/extension/plugins-sandbox.js"],"sourceRoot":""}