<html>
<head><script src="jquery/jquery-1.4.2.min.js"></script></head>
<body>
<script type="text/javascript">

function calculateDomains() {

domains = {
  "facebook.com" : { "facebook.com" : true, "fbcdn.net" : true }, 
  "facebook.net" : { "facebook.com" : true, "fbcdn.net" : true }, 
  "fbcdn.net" : { "facebook.com" : true, "fbcdn.net" : true },
  "fbshare.me" : {},
  "platform.twitter.com" : { "twitter.com" : true },
  "twitter.com" : { "twitter.com" : true },
  "disqus.com" : {},
  "digg.com" : {},
  "meebo.com" : {},
  "meebocdn.net" : { "meebo.com" : true },
  "publitweet.com" : {},
  "lijit.com" : {},
  "chartbeat.com" : {},
  "chartbeat.net" : { "chartbeat.com" : true },
  "causes.com" : {},
  "tweetup.com" : { "postup.com" : true },
  "postup.com" : {},
  "conduit.com" : {},
  "conduit-banners.com" : { "conduit.com" : true },
  "quantserve.com" : {},
  "google-analytics.com" : {},
  "gravatar.com" : {},
  "google.com/buzz" : {},
  "google.com/cse" : {},
  "google.com/friendconnect" : {},
  "stats.wordpress.com" : {},
  "scorecardresearch.com" : {},
  "speakertext.com" : {},
  "snap.com" : {},
  "snapabug.com" : {},
  "revsci.net" : {},
  "badgeville.com" : {},
  "chomp.com" : {},
  "wibiya.com" : {},
  "addthis.com" : {},
  "addthiscdn.com" : { "addthis.com" : true },
  "woopra.com" : {},
  "woopra-ns.com" : { "woopra.com" : true },
  "apture.com/js/apture.js" : {},
  "js-kit.com" : {},
  "yaptor.com" : {},
  "tweetmeme.com" : {},
  "get-clicky.com" : { "getclicky.com" : true},
  "getclicky.com" : {},
  "fmpub.net" : {},
  "typekit.com" : {},
  "buysellads.com" : {},
  "sharethis.com" : {},
  "outbrain.com" : {},
  "adtech.us" : {},
  "mar.gy" : {},
  "mixpanel.com" : {},
  "kissmetrics.com" : {},
  "viglink.com" : {},
  "fyre.co" : {},
  "assistly.com" : {},
  "stumbleupon.com" : {},
  "delicious.com" : {},
  "uservoice.com" : {},
  "platform.linkedin.com" : { "linkedin.com" : true },
  "widgets.dzone.com" : { "dzone.com" : true },
  "envolve.com" : {},
  "vkontakte.ru" : {},
  "apis.google.com/js/plusone" : {},
  "amung.us" : {},

};

// remove domains disabled in settings
for (var domain in domains) {
  if (localStorage[domain] === "false") {
    for(var reverse_domains in domains) {
      if (domains[reverse_domains][domain]) {
        delete domains[reverse_domains];
      }
    }
    delete domains[domain];
  }
}

return domains;
}

chrome.extension.onRequest.addListener(
function(request, sender, sendResponse) {
  if (request.call == "calculateDomains") {
    sendResponse({ domains : calculateDomains() });
  }
});

</script>

</body>
</html>
